window.addEventListener("DOMContentLoaded",(function(e){"use strict";const t=document.querySelector("html"),l=document.querySelector("body"),s=document.querySelector("#all-items"),i=document.querySelectorAll(".lists-page__item-checkbox"),a=document.querySelectorAll(".lists-page__options-buttons .option");!function(){let e=!1;for(let t=0;t<i.length;t++)if(i[t].closest(".list-panel").classList.contains("active")){e=!0;break}e?b():L()}();const o=document.querySelector(".lists-page__options"),c=1*window.getComputedStyle(o).getPropertyValue("height").replace("px",""),n=1*window.getComputedStyle(o).getPropertyValue("width").replace("px",""),d=o.closest(".col-inner"),r=document.querySelector(".lists-page__left"),u=document.querySelector(".header"),p=1*window.getComputedStyle(u).getPropertyValue("height").replace("px","");function m(){let e=document.querySelectorAll(".lists-page__item"),t=0;for(let l=0;l<e.length;l++)e[l].closest(".list-panel").classList.contains("active")&&t++;t>=2?o.classList.add("can-be-fixed"):(o.classList.remove("can-be-fixed"),o.classList.remove("fixed"),o.classList.remove("bottom"),o.style.top="auto",o.style.bottom="auto",r.style.paddingTop=0)}m();const g=document.querySelector(".lists-page__sidebar_outer"),h=document.querySelector(".lists-page__sidebar"),f=window.getComputedStyle(g).getPropertyValue("width").replace("px","");function _(){let e=1*window.getComputedStyle(g).getPropertyValue("height").replace("px","");e<1*window.getComputedStyle(r).getPropertyValue("height").replace("px","")&&window.matchMedia("(min-width: 1025px)").matches&&window.innerHeight-p>e?g.classList.add("can-be-fixed"):(g.classList.remove("can-be-fixed"),g.classList.remove("fixed"),g.classList.remove("bottom"),g.style.top="auto",g.style.bottom="auto")}function L(){s.classList.add("disabled"),s.checked=!1,y(0)}function b(){s.classList.remove("disabled")}function v(e,t){e.checked=t,t?e.closest(".lists-page__item").classList.add("selected"):e.closest(".lists-page__item").classList.remove("selected")}function y(e){for(let t=0;t<a.length;t++)e?a[t].classList.remove("disabled"):a[t].classList.add("disabled")}_(),window.addEventListener("scroll",(function(){if(o.classList.contains("can-be-fixed")){let e=void 0!==window.pageYOffset?window.pageYOffset:document.documentElement||document.body.parentNode||document.body,t=r.getBoundingClientRect().top+window.pageYOffset,l=d.getBoundingClientRect().bottom+e,s=function(){let e=[],t=document.querySelectorAll(".lists-page__item");for(let l=0;l<t.length;l++)t[l].closest(".list-panel").classList.contains("active")&&e.push(t[l]);return e[e.length-2]}().getBoundingClientRect().bottom+e,i=l-s,a=e+p;a>=t?(o.classList.add("fixed"),o.classList.remove("bottom"),o.style.top=p+"px",o.style.bottom="auto",o.style.width=n+"px",r.style.paddingTop=c+"px",s-c+1<=a&&(o.classList.remove("fixed"),o.classList.add("bottom"),o.style.top="auto",o.style.bottom=i+"px")):(o.classList.remove("fixed"),o.style.top="auto",o.style.bottom="auto",r.style.paddingTop=0)}})),window.addEventListener("scroll",(function(){if(g.classList.contains("can-be-fixed")){let e=void 0!==window.pageYOffset?window.pageYOffset:document.documentElement||document.body.parentNode||document.body,t=h.getBoundingClientRect().top+window.pageYOffset,l=r.getBoundingClientRect().bottom+window.pageYOffset,s=window.getComputedStyle(g).getPropertyValue("height").replace("px",""),i=e+p+10;i>t?(g.classList.add("fixed"),g.classList.remove("bottom"),g.style.width=f+"px",g.style.top=p+10+"px",g.style.bottom="auto",l-s<=i&&(g.classList.add("bottom"),g.classList.remove("fixed"),g.style.top="auto",g.style.bottom=0)):(g.classList.remove("fixed"),g.style.top="auto")}})),s.addEventListener("input",(function(){let e=document.querySelectorAll(".lists-page__item-checkbox");if(this.checked)for(let t=0;t<e.length;t++)e[t].closest(".list-panel").classList.contains("active")?v(e[t],!0):v(e[t],!1),y(1);else{for(let t=0;t<e.length;t++)v(e[t],!1);y(0)}})),$(document).on("click",".lists-page__item-checkbox",(function(){!function(e){e.checked?e.closest(".lists-page__item").classList.add("selected"):e.closest(".lists-page__item").classList.remove("selected");0!=function(){let e=document.querySelectorAll(".lists-page__item-checkbox"),t=[],l=[];for(let s=0;s<e.length;s++)e[s].closest(".list-panel").classList.contains("active")&&l.push(e[s]),e[s].checked&&t.push(e[s]);t.length<l.length?s.checked=!1:t.length==l.length&&0!=l.length&&(s.checked=!0);return t}().length?y(1):y(0)}(this)}));const w=document.querySelector(".delete-items-btn"),S=(document.querySelectorAll(".lists-page__delete-list"),$(".overlay"));function C(e){x();let t=$("#popup-delete");t.addClass("delete-list"),t.attr("data-delete",e.getAttribute("data-delete-tab"))}function x(){let e=$("#popup-delete");S.fadeIn(),scrollLock.disablePageScroll(),e.fadeIn("400"),e.addClass("animate__slideInRight animate__animated"),e.addClass("active"),t.classList.add("pum-open")}w.addEventListener("click",(function(){x(),$("#popup-delete").addClass("delete-items")})),$(document).on("click",".lists-page__delete-list",(function(){C(this)}));document.querySelector(".delete-btn").addEventListener("click",(function(){let e=$("#popup-delete");if(l.classList.contains("lists-page")){if(e.hasClass("delete-items")){let e=document.querySelectorAll(".lists-page__item");for(let t=0;t<e.length;t++){let l=e[t].closest(".list-panel"),s=e[t].closest(".row");l.classList.contains("active")&&e[t].classList.contains("selected")&&s.removeChild(e[t])}s.checked=!1;let t=document.querySelectorAll(".lists-page__item"),l=!1;for(let e=0;e<t.length;e++)if(t[e].closest(".list-panel").classList.contains("active")){l=!0;break}l?s.classList.remove("disabled"):s.classList.add("disabled"),y(0),m()}else if(e.hasClass("delete-list")){let t=document.querySelector(".lists-page__editing"),l=document.querySelector(".lists-page__lists"),s=document.querySelector('[data-tab="'+e.attr("data-delete")+'"]'),i=document.querySelector('[data-panel="'+e.attr("data-delete")+'"]');t.removeChild(s.closest(".lists-page__editing-item")),i.classList.contains("active")?(l.removeChild(i),q(document.querySelector('[data-tab="list-0"]'),!1)):(l.removeChild(i),window.matchMedia("(max-width: 1024px)").matches||B())}_()}}));document.querySelectorAll(".lists-page__editing-name");function q(e,t){if(!e.classList.contains("active")){!function(){let e=document.querySelectorAll(".lists-page__item-checkbox");for(let t=0;t<e.length;t++)v(e[t],!1);L()}(),function(){let e=document.querySelectorAll(".list-tab"),t=document.querySelectorAll(".list-panel");for(let l=0;l<e.length;l++)e[l].classList.remove("active"),t[l].classList.remove("active")}(),e.classList.add("active"),document.querySelector('[data-panel="'+e.getAttribute("data-tab")+'"]').classList.add("active");let t=document.querySelectorAll(".lists-page__item"),l=!1;for(let e=0;e<t.length;e++)t[e].closest(".list-panel").classList.contains("active")&&(l=!0);l&&b()}m(),_(),window.matchMedia("(max-width: 1024px)").matches?t&&k():B()}function k(){let e=r.getBoundingClientRect().top+window.pageYOffset;if(!(Math.max(document.body.scrollTop,document.documentElement.scrollTop)<e-p-1))return!1;window.scrollBy(0,10);setTimeout(k,2)}function B(){let e=r.getBoundingClientRect().top+window.pageYOffset;if(!(Math.max(document.body.scrollTop,document.documentElement.scrollTop)>e-p-1))return!1;window.scrollBy(0,-10);setTimeout(B,2)}$(document).on("click",".lists-page__editing-name",(function(e){q(this,!0)}));document.querySelectorAll(".edit-list-btn");let A=document.querySelector('#popup-edit-list input[name="newListName"]');function E(e){let l=$("#popup-edit-list");S.fadeIn(),scrollLock.addScrollableSelector(".popup .wrapper__inner"),scrollLock.disablePageScroll(),l.fadeIn("400"),l.addClass("animate__slideInRight animate__animated"),l.addClass("active"),t.classList.add("pum-open"),l.attr("data-edit",e.getAttribute("data-edit-tab")),A.focus(),A.value=document.querySelector('[data-tab="'+e.getAttribute("data-edit-tab")+'"]').textContent,""!=A.value&&""!=A.value.replace(/\s/g,"")?H.classList.remove("disabled"):H.classList.add("disabled")}$(document).on("click",".edit-list-btn",(function(){E(this)}));let M=document.querySelector("#popup-create-list .create-list-submit"),H=document.querySelector("#popup-edit-list .create-list-submit"),P=document.querySelector('#popup-create-list input[name="newListName"]'),T=document.querySelector(".lists-page__lists");M.addEventListener("click",(function(){let e=document.querySelector(".lists-page__editing"),t=document.createElement("div"),l=document.createElement("div"),s=document.createElement("p"),i=document.createElement("p"),a=document.createElement("div"),o=document.createElement("button"),c=document.createElement("button");e.appendChild(t),t.classList.add("col","col-12","lists-page__editing-item"),l.classList.add("col-inner"),t.appendChild(l),l.appendChild(s),l.appendChild(i),l.appendChild(a);let n=document.querySelectorAll(".list-tab"),d=1*n[n.length-1].getAttribute("data-tab").replace("list-","")+1;s.classList.add("lists-page__editing-name","list-tab"),s.setAttribute("data-tab","list-"+d),s.textContent=P.value,s.addEventListener("click",(function(e){q(this,!0)})),i.classList.add("mb-0"),i.innerHTML='Кол-во позиций: <span class="lists-page__total-list-item">0</span>',a.classList.add("lists-page__editing-icons"),a.appendChild(o),a.appendChild(c),o.classList.add("icon-btn","edit-list-btn","lists-page__edit-name"),o.setAttribute("data-edit-tab","list-"+d),o.innerHTML='<svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_614_12399)"><path d="M0.567851 23.9395L0.567531 23.9395C0.554698 23.9427 0.546699 23.9415 0.540916 23.9398C0.533836 23.9377 0.525383 23.9332 0.517496 23.9254C0.50959 23.9176 0.504571 23.9088 0.50211 23.9009C0.500029 23.8943 0.498839 23.8857 0.501682 23.8729L1.53682 19.2219L5.14308 22.8302L0.567851 23.9395ZM3.27548 16.9023L14.9238 5.25139L19.0988 9.42634L7.44798 21.0772L3.27548 16.9023ZM20.9797 1.5431L23.157 3.72035C23.6143 4.17769 23.6143 4.91359 23.157 5.371C23.157 5.371 23.157 5.371 23.157 5.37101L21.0778 7.45016L16.9028 3.27513L18.6342 1.5437C18.6344 1.54355 18.6345 1.5434 18.6347 1.54325C19.2842 0.8964 20.334 0.897407 20.9797 1.5431Z" stroke="#BBBBBB"></path></g><defs><clipPath id="clip0_614_12399"><rect width="24" height="24" fill="white" transform="translate(0 0.5)"></rect></clipPath></defs></svg>',c.classList.add("icon-btn","lists-page__delete-list"),c.setAttribute("data-delete-tab","list-"+d),c.innerHTML='<svg width="24" height="25" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_614_12378)"><path d="M6.66669 24C5.46945 24 4.5 23.0305 4.5 21.8333V6.33331H19.5V21.8333C19.5 23.0305 18.5305 24 17.3334 24H6.66669Z" stroke="#BBBBBB"></path><path d="M16.3125 2.18687L16.4589 2.33331H16.666H20.8326V4H3.16602V2.33331H7.33264H7.53974L7.68619 2.18687L8.87312 1H15.1255L16.3125 2.18687Z" stroke="#BBBBBB"></path></g><defs><clipPath id="clip0_614_12378"><rect width="24" height="24" fill="white" transform="translate(0 0.5)"></rect></clipPath></defs></svg>',o.addEventListener("click",(function(){E(this)})),c.addEventListener("click",(function(){C(this)}));let r=document.createElement("div");T.appendChild(r),r.classList.add("col","col-12","lists-page__list","pb-0","list-panel"),r.setAttribute("data-panel","list-"+d),r.innerHTML='<div class="col-inner"><div class="row"><div class="col col-12 lists-page__total"><div class="col-inner"><div class="prices lists-page__total-price"><div class="price price_new"><p class="mb-0">Итого:</p><p class="num">0,00</p><p class="symbol">₽</p></div></div></div></div></div></div>',_()})),H.addEventListener("click",(function(){let e=$("#popup-edit-list");document.querySelector('[data-tab="'+e.attr("data-edit")+'"]').textContent=A.value,_()}));const V=document.querySelector("#submit-choose-lists");localStorage.getItem("activetab")&&(q(document.querySelectorAll(".lists-page__editing-name")[localStorage.getItem("activetab")],!1),localStorage.removeItem("activetab")),V.addEventListener("click",(function(e){e.preventDefault(),function(){let e=document.querySelectorAll(".lists-page__editing-name");for(let t=0;t<e.length;t++)e[t].classList.contains("active")&&localStorage.setItem("activetab",t)}()})),$(document).on("ajaxComplete",(function(e){console.log("ajax")}))}));